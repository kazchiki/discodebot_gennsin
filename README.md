# 原神Discord Bot

原神のプレイヤー情報とキャラクター詳細を取得できるDiscord Botです。  
TypeScriptで書かれており、個人データの保存機能付きで快適に使用できます。

## ✨ 機能

### 📊 プレイヤー情報表示
- 冒険ランク、世界ランク、深境螺旋進捗
- プロフィール画像、ステータスメッセージ
- 所持キャラクター一覧（ボタン付き）

### 🎭 キャラクター詳細
- レベル、命ノ星座、戦闘ステータス
- 天賦レベル、聖遺物情報
- 自動保存機能（自分のキャラクターのみ）

### 💾 個人データ管理
- **複数UID対応**: 複数のアカウントを登録・切り替え可能
- **ニックネーム機能**: アカウントに分かりやすい名前を設定
- **キャラクター保存**: 取得したキャラクター情報を自動保存
- **プライバシー保護**: 自分のデータのみ保存・表示

### 🎯 HoyoLab風育成計画
- **セレクトメニュー**: 保存キャラクターから視覚的に選択
- **パーソナライズ**: あなたの実際のキャラクターデータを使用
- **段階的プラン**: レベル20/40/50/60/70/80/90の各段階を提案
- **詳細コスト**: モラ、経験書、昇格素材の必要量を正確に計算
- **進捗表示**: 現在の育成状況を視覚的に表示
- **柔軟な操作**: 引数なしでも、目標レベルのみでも利用可能

### 🚀 便利機能
- **スラッシュコマンド対応**: モダンなDiscordインターフェース
- **UID省略可能**: 登録済みなら引数不要
- **セレクトメニューUI**: ボタンより省スペースで直感的
- **柔軟な操作**: 引数なしでもメニュー選択で操作可能
- **自動データ更新**: キャラクター情報の変更を自動検出

## 🎮 コマンド一覧

原神Discordボットは以下の**8個**のスラッシュコマンドを提供します：

### 🎯 基本情報コマンド
- `/genshin [uid]` - 原神プレイヤー情報を表示
- `/character キャラクター名 [uid]` - 特定キャラクターの詳細情報を表示

### 👤 個人データ管理
- `/register-uid UID [ニックネーム]` - あなたのUIDを登録・更新
- `/my-genshin` - 登録済みのUIDで原神情報を表示
- `/my-characters` - 保存キャラクターをセレクトメニューで選択・詳細表示
- `/my-character [キャラクター名]` - セレクトメニューまたは名前指定でキャラクター詳細を表示

### 🔄 複数アカウント管理
- `/my-accounts` - 登録済みのアカウント一覧を表示
- `/switch-uid UID` - アクティブなUIDを切り替え

### 🎯 HoyoLab風育成計画機能
- `/my-character-build [キャラクター名] [目標レベル]` - **あなたの保存キャラクターの育成計画を立案**
  - 引数なし：セレクトメニューでキャラクター選択
  - キャラクター名のみ：選択キャラクターの総合育成プラン表示
  - 両方指定：具体的な育成コストを計算

## 📱 使用例

### 🔧 初回設定
```
/register-uid UID:801000880 ニックネーム:メインアカウント
/register-uid UID:605000723 ニックネーム:サブアカウント
```

### 📊 情報取得（自動保存）
```
/genshin                          # アクティブUIDの情報表示
/character character_name:胡桃    # 胡桃の詳細情報（自動保存）
```

### 🔄 アカウント切り替え
```
/my-accounts                      # 登録済みアカウント一覧
/switch-uid uid:605000723        # サブアカウントに切り替え
```

### 💾 保存データの確認
```
/my-characters                    # セレクトメニューでキャラクター選択→詳細表示
/my-character                     # セレクトメニューでキャラクター選択
/my-character character_name:胡桃 # 胡桃の保存データを直接表示
```

### 🎯 育成計画の立案
```
/my-character-build                              # セレクトメニューでキャラクター選択
/my-character-build character_name:胡桃           # 胡桃の総合育成プラン表示
/my-character-build character_name:胡桃 目標レベル:80  # レベル80まで育成コスト
/my-character-build 目標レベル:90                 # セレクトメニューでレベル90育成
```

## 🏗️ プロジェクト構造

```
src/
├── index.ts                    # メインファイル（ボット起動・イベント処理）
├── types/
│   └── index.ts               # TypeScript型定義
├── constants/
│   └── commands.ts            # コマンド名・説明の一元管理
├── data/
│   └── characters.ts          # キャラクター名マッピング
├── utils/
│   ├── userData.ts            # ユーザーデータ永続化
│   ├── buildCalculator.ts     # 育成コスト計算エンジン
│   └── characterMapping.ts    # 動的キャラクター名変換
└── commands/
    ├── index.ts               # スラッシュコマンド定義
    ├── genshin.ts             # 原神プレイヤー情報取得
    ├── character.ts           # キャラクター詳細表示
    ├── register.ts            # UID登録・管理
    ├── myGenshin.ts           # 個人データ表示
    ├── myCharacters.ts        # 保存キャラクター管理
    ├── accounts.ts            # 複数アカウント管理
    └── myBuildPlan.ts         # HoyoLab風育成計画機能
```

## 🔧 開発・実行

### 開発モード
```bash
npm run dev
```

### 本番ビルド・実行
```bash
npm run build
npm start
```

### その他のコマンド
```bash
npm run watch    # ファイル変更監視
```

## 💾 データ保存

ユーザーデータは `userData.json` に保存されます（複数アカウント対応）：

```json
{
  "DiscordユーザーID": {
    "accounts": {
      "801000880": {
        "uid": "801000880",
        "nickname": "メインアカウント",
        "lastUpdated": "2024-01-01T00:00:00.000Z"
      },
      "605000723": {
        "uid": "605000723", 
        "nickname": "サブアカウント",
        "lastUpdated": "2024-01-01T00:00:00.000Z"
      }
    },
    "activeUID": "801000880",
    "characters": {
      "801000880": {
        "キャラクターID": {
          "data": { /* EnkaNetworkAPIデータ */ },
          "characterName": "胡桃（炎）",
          "lastUpdated": "2024-01-01T00:00:00.000Z"
        }
      },
      "605000723": {
        "キャラクターID": {
          "data": { /* EnkaNetworkAPIデータ */ },
          "characterName": "神里 綾華（氷）", 
          "lastUpdated": "2024-01-01T00:00:00.000Z"
        }
      }
    }
  }
}
```

## 🔗 使用API・参考資料

- **API**: [Enka Network](https://enka.network/) - 原神のプレイヤーデータを提供
- **参考記事**: [原神のステータスを取得するDiscordBotを作った話](https://qiita.com/CinnamonSea2073/items/92d9a479888b8581b2e2)

## 🛡️ プライバシー

- 登録したUIDは個人のみアクセス可能
- キャラクター情報は自分のUIDで取得した場合のみ自動保存
- 他人のデータを覗くことはできません

## 📝 ライセンス

ISC